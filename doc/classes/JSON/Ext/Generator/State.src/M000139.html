<?xml version="1.0" encoding="iso-8859-1"?>
<!DOCTYPE html 
     PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
     "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html>
<head>
  <title>partial_generate (JSON::Ext::Generator::State)</title>
  <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" />
  <link rel="stylesheet" href="../../../../.././rdoc-style.css" type="text/css" media="screen" />
</head>
<body class="standalone-code">
  <pre>/*
 * call-seq: partial_generate(obj)
 *
 * Generates a part of a JSON document from object +obj+ and returns the
 * result.
 */
static VALUE cState_partial_generate(VALUE self, VALUE obj, VALUE depth)
{
    VALUE result;
    FBuffer *buffer = fbuffer_alloc();
    GET_STATE(self);

    if (state-&gt;object_delim) {
        fbuffer_clear(state-&gt;object_delim);
    } else {
        state-&gt;object_delim = fbuffer_alloc_with_length(16);
    }
    fbuffer_append_char(state-&gt;object_delim, ',');
    if (state-&gt;object_delim2) {
        fbuffer_clear(state-&gt;object_delim2);
    } else {
        state-&gt;object_delim2 = fbuffer_alloc_with_length(16);
    }
    fbuffer_append_char(state-&gt;object_delim2, ':');
    if (state-&gt;space) fbuffer_append(state-&gt;object_delim2, state-&gt;space, state-&gt;space_len);

    if (state-&gt;array_delim) {
        fbuffer_clear(state-&gt;array_delim);
    } else {
        state-&gt;array_delim = fbuffer_alloc_with_length(16);
    }
    fbuffer_append_char(state-&gt;array_delim, ',');
    if (state-&gt;array_nl) fbuffer_append(state-&gt;array_delim, state-&gt;array_nl, state-&gt;array_nl_len);

    generate_json(buffer, self, state, obj, NIL_P(depth) ? 0 : FIX2INT(depth));
    result = fbuffer2rstring(buffer);
    fbuffer_free_only_buffer(buffer);
    FORCE_UTF8(result);
    return result;
}</pre>
</body>
</html>